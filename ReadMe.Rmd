---
title: "Sentiment Analysis of Twitter's reaction to #SONA2019"
output: html_notebook
---

Cyril Ramaphosa, the current president of South Africa, gave his state of the nation address to parliament on the 7 February 2019. His political party, the African National Congress were initially considered to be pioneers of hope and prosperity for a new South Africa in the wake of the apartheid. However, more recently, the African National Congress has become synonymous with political corruption and greed. 

Given South Africa’s storied past, I decided to perform a sentiment analysis on the reaction to the president’s latest state of the nation address by analysing tweets using the hashtag “SONA2019”. 

# Install Required Packages 
```{r}
# install.packages("dplyr")
# install.packages("magrittr")
# install.packages("plotly")
# install.packages("rtweet")
# install.packages("tidytext")
# install.packages("tm")
# install.packages("syuzhet")
# install.packages("wordcloud")
```
# Load Libraries 
```{r}
library(tidytext)
library(magrittr)
library(dplyr)
library(syuzhet)

library(wordcloud)
```
# Get and Clean Data
```{r}
# Load tweets obtained with twitter developer API

tweets.df <- read.csv("sona2019.csv", stringsAsFactors = FALSE, row.names = 1)

# Write a function to clean the tweets

clean.tweets <- function(doc) {
  doc <- gsub("http.*","",  doc)
  doc <- gsub("https.*","", doc)
  doc <- gsub("http.*","",tweets.df$text)
  doc <- gsub("https.*","",doc)
  doc <- gsub("#.*","",doc)
  doc <- gsub("@.*","",doc)
  doc <- iconv(doc, "UTF-8", "ASCII", sub="")
  return(doc)
}

# Apply function

tweets.df$text <- sapply(tweets.df$text, clean.tweets)

```
# Sentiment Analysis
```{r}
# Load syuzhet library 

library(syuzhet)

# Perform sentiment analysis using the syuzhet library

allemotions <- get_nrc_sentiment(tweets.df$text)

# Create variable with just positive and negative emotions 

sona_posneg <- allemotions %>%
               select("positive", "negative")

# Create variable with a spectrum of emotions 

sona_emotions <- allemotions %>%
                 select("trust", "anticipation", "fear", "joy", "anger", "sadness", "surprise", "disgust")

# Create a dataframe that summarises sentiment in descending order

emotion_bar <- colSums(sona_emotions) 
emotion_sum <- data.frame(count=emotion_bar, sona_emotions=names(emotion_bar))
emotion_sum$sona_emotions <- factor(emotion_sum$sona_emotions, levels=emotion_sum$sona_emotions[order(emotion_sum$count, decreasing = TRUE)])
```

```{r}

# Visualise sentiment

library(plotly)

emotion_plot <- plot_ly(emotion_sum,
             x=~sona_emotions, 
             y=~count, 
             type="bar", 
             color=~sona_emotions) %>%
             layout (
                xaxis = list(
                     title=""), showlegend=FALSE,
             title="Emotion Type for hashtag: #SONA2019")

emotion_plot
```
At first glance, twitter's reaction to #SONA2019 appears to be quite positive. Trust has a count of 11259, which is 150% greater than second place Anticipation. In third place, Fear has a count of 5535, which half of the reaction to Trust. However, words that convey sentiment are often contextual and this may bias the results. Further analysis is needed to determine the validity of these results. 
# Text Mining 




